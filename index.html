<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Equipment Map</title>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
    <!-- Leaflet MarkerCluster CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
    <!-- Leaflet MarkerCluster JS -->
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; }
        #map { height: calc(100vh - 100px); width: 100%; }
        h2 { text-align: center; padding: 10px; font-size: 18px; background: #007bff; color: white; margin: 0; }
        .popup-content { font-size: 12px; line-height: 1.3; }
        .popup-content a { color: #007bff; text-decoration: none; }
        #controls { padding: 10px; background: #f8f9fa; text-align: center; position: relative; }
        #search { width: 60%; padding: 5px; margin-right: 10px; }
        #filter { padding: 5px; }
        #search-dropdown {
            position: absolute;
            top: 40px;
            left: 20%;
            width: 60%;
            max-height: 200px;
            overflow-y: auto;
            background: white;
            border: 1px solid #ccc;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none;
        }
        .dropdown-item {
            padding: 5px 10px;
            cursor: pointer;
        }
        .dropdown-item:hover {
            background: #f0f0f0;
        }
    </style>
</head>
<body>
    <h2>Electrical Equipment in Seraikela</h2>
    <div id="controls">
        <input type="text" id="search" placeholder="Search by equipment name...">
        <div id="search-dropdown"></div>
        <select id="filter">
            <option value="all">All Equipment</option>
            <option value="transformer">Transformers (DT)</option>
            <option value="rmu">RMUs</option>
            <option value="substation">Substations</option>
        </select>
    </div>
    <div id="map"></div>
    <script>
        // Initialize the map
        var map = L.map('map').setView([22.80222549, 86.13745], 12);
        // Add Google Satellite tiles
        L.tileLayer('http://mt0.google.com/vt/lyrs=m&hl=en&x={x}&y={y}&z={z}', {
            attribution: '¬© OpenStreetMap contributors'
        }).addTo(map);
        // Define custom icons
        var icons = {
            transformer: L.icon({ iconUrl: 'https://img.icons8.com/?size=100&id=e1W8qPyHmBSb&format=png&color=000000', iconSize: [25, 25] }),
            rmu: L.icon({ iconUrl: 'https://img.icons8.com/?size=100&id=J4l0714N594x&format=png&color=000000', iconSize: [25, 25] }),
            substation: L.icon({ iconUrl: 'https://img.icons8.com/?size=100&id=G0U0UHySUjNW&format=png&color=000000', iconSize: [20, 20] }),
            user: L.icon({ iconUrl: 'https://img.icons8.com/?size=100&id=108652&format=png&color=000000', iconSize: [40, 40] })
        };
        // Full equipment data (659 entries, truncated here for brevity)
        var equipment = [
                ["7 STAR DT", 22.80371, 86.11534, "transformer"],
    ["A V Engg DT/ Precon", 22.77626, 86.13733, "transformer"],
    ["AADHARSHILA DT", 22.77923, 86.16203, "transformer"],
    ["AAKRITI SHINE DT", 22.82113, 86.08825, "transformer"],
    ["AASTHA ARCADE DT", 22.79347, 86.1641, "transformer"],
    ["Aditya Ashiana DT1", 22.79364, 86.12838, "transformer"],
    ["Aditya Ashiana DT2", 22.79361, 86.12835, "transformer"],
    ["Aditya Ashiana DT3", 22.79359, 86.12832, "transformer"],
    ["Aditya Ashiana DT4", 22.79357, 86.1283, "transformer"],
    ["ADITYA GARDEN DT-1", 22.79485, 86.14341, "transformer"],
    ["ADITYA GARDEN DT-2", 22.79613, 86.14359, "transformer"],
    ["ADITYA GARDEN DT-3", 22.79749, 86.14415, "transformer"],
    ["ADITYA GREEN DT", 22.79119, 86.16907, "transformer"],
    ["ADITYAPUR DIES DT", 22.7898, 86.14588, "transformer"],
    ["Agro Mills DT", 22.78737, 86.14729, "transformer"],
    ["ALMAMET DT", 22.77742, 86.13508, "transformer"],
    ["AMIT TRADING DT", 22.79864, 86.12271, "transformer"],
    ["ANAC DT", 22.78732, 86.15331, "transformer"],
    ["ANAND VIHAR DT", 22.79683, 86.14043, "transformer"],
    ["ARORA FOODS DT", 22.78841, 86.14509, "transformer"],
    ["ASHIYANA DT", 22.79066, 86.15455, "transformer"],
    ["ASIA DT", 22.79744, 86.13262, "transformer"],
    ["ASSOCIATE ENGIFEB DT", 22.78528, 86.13542, "transformer"],
    ["ASTHA FERROTECH DT", 22.7895, 86.1389, "transformer"],
    ["ATUL DT", 22.77817, 86.1325, "transformer"],
    ["Auto Craft DT", 22.80457, 86.11151, "transformer"],
    ["AUTO RUBBER DT", 22.78654, 86.14951, "transformer"],
    ["AUTOMECH ENGG. DT", 22.78718, 86.14719, "transformer"],
    ["BADAMARI DT", 22.86978, 86.09083, "transformer"],
    ["BAJAJ FAIDERAL DT", 22.78705, 86.14393, "transformer"],
    ["BAJRANG LAL GOYAL DT", 22.811, 86.10954, "transformer"],
    ["BAJRANG TOWER DT", 22.81681, 86.10016, "transformer"],
    ["BALAJI ENTERPRISE DT / LS", 22.83041, 86.06993, "transformer"],
    ["BALAJI KRISHNA DT", 22.80343, 86.11797, "transformer"],
    ["Balak Madhya Vidyalaya SK DT", 22.70702, 85.93994, "transformer"],
    ["BALIGUMA DT#2", 22.79949, 86.02883, "transformer"],
    ["BALRAM APARTMENT DT", 22.80298, 86.13002, "transformer"],
    ["BANK COLONY DT-1", 22.79518, 86.16195, "transformer"],
    ["BANK COLONY DT-2", 22.79319, 86.16289, "transformer"],
    ["BANPRIYA DT", 22.78365, 86.12689, "transformer"],
    ["BANTANAGAR DT", 22.7743, 86.1618, "transformer"],
    ["BDR FURNITURE DT", 22.79017, 86.14057, "transformer"],
    ["BEBBCO ENGG. DT", 22.80887, 86.11351, "transformer"],
    ["BHARDWAJ BROTHERS DT", 22.77774, 86.13404, "transformer"],
    ["Bhardwaj DT", 22.79856, 86.12278, "transformer"],
    ["BHOLADIH DT", 22.80271, 86.03006, "transformer"],
    ["BIHAR INSECTICIDES DT", 22.7822, 86.13768, "transformer"],
    ["BIRBANS DT", 22.8005, 86.03602, "transformer"],
    ["BIRBANS S/S DT", 22.8005, 86.03598, "transformer"],
    ["BLUE STAR BRICKS DT / PH#5", 22.82397, 86.09047, "transformer"],
    ["CHAMPANAGER DT", 22.85246, 86.09037, "transformer"],
    ["CHANDRA CHEMICALS DT", 22.79886, 86.11591, "transformer"],
    ["CHIRUGUDA DT", 22.86357, 86.08994, "transformer"],
    ["CHITRAKOOT DT", 22.79212, 86.16836, "transformer"],
    ["CHOTA HARIHARPUR DT", 22.83176, 86.06092, "transformer"],
    ["CITY CLASSICS DT", 22.78781, 86.16325, "transformer"],
    ["Civil Court SK DT", 22.70406, 85.93535, "transformer"],
    ["D R SON'S DT", 22.78144, 86.13651, "transformer"],
    ["DAV DT", 22.77673, 86.15535, "transformer"],
    ["DAYAL PRATAP DT", 22.81258, 86.1066, "transformer"],
    ["DC Residence SK DT", 22.7097, 85.94365, "transformer"],
    ["DEEKAY ENT. DT", 22.79705, 86.12936, "transformer"],
    ["DEEPAK ENGG. DT", 22.80219, 86.10724, "transformer"],
    ["DIKSHA DT", 22.79822, 86.12665, "transformer"],
    ["DJ ENTERPRISES DT", 22.79862, 86.12023, "transformer"],
    ["DT AUTO CRAT PH7", 22.80461, 86.11092, "transformer"],
    ["DT MANOJ ENTERPRISE PH7", 22.80415, 86.10949, "transformer"],
    ["DURGA PUJA MAIDAN DT", 22.81681, 86.10085, "transformer"],
    ["DURGA STEEL DT", 22.78597, 86.134, "transformer"],
    ["EASTERN COATING DT", 22.80085, 86.12214, "transformer"],
    ["EFFECTIVE MARKETING DT", 22.80097, 86.12352, "transformer"],
    ["EMC OFFICE DT PH7", 22.80226, 86.14168, "transformer"],
    ["EMC S/S DT", 22.79969, 86.13606, "transformer"],
    ["ESIC DT", 22.79594, 86.15469, "transformer"],
    ["FORAM MALL DT", 22.79992, 86.12668, "transformer"],
    ["FOUJI DT", 22.82601, 86.07288, "transformer"],
    ["G.B ENTERPRISES DT", 22.78938, 86.14067, "transformer"],
    ["GAIL DT", 22.81116, 86.14369, "transformer"],
    ["GANESH MINERAL", 22.78346, 86.14476, "transformer"],
    ["GANJIA DT", 22.7608, 86.08724, "transformer"],
    ["Ganpati DT", 22.81655, 86.10357, "transformer"],
    ["Garage Chowk SK DT", 22.70211, 85.9318, "transformer"],
    ["GARG ENGG. DT", 22.80196, 86.11508, "transformer"],
    ["GAURAV ENCLAVE DT", 22.81204, 86.10116, "transformer"],
    ["GHURING DT", 22.83039, 86.08128, "transformer"],
    ["Girl School SK DT", 22.70101, 85.93024, "transformer"],
    ["GOLDEN HERITAGE DT", 22.80605, 86.12625, "transformer"],
    ["GOPIDIH DT", 22.80926, 86.03146, "transformer"],
    ["GORIAN DT", 22.83034, 86.08116, "transformer"],
    ["Haat SK DT", 22.70221, 85.92783, "transformer"],
    ["HARI OM NAGAR DT", 22.7914, 86.16427, "transformer"],
    ["HARISUNDERPUR DT", 22.84923, 86.09469, "transformer"],
    ["HENSAHUDI DT", 22.70203, 85.92375, "transformer"],
    ["Hindustan Foundary PH1", 22.77594, 86.13302, "transformer"],
    ["HINDUSTAN POLYTEX DT", 22.7881, 86.14353, "transformer"],
    ["HIRA TOWER DT", 22.78377, 86.17166, "transformer"],
    ["IDTR BOYS HOSTEL DT", 22.80563, 86.11493, "transformer"],
    ["IDTR DT", 22.78876, 86.16885, "transformer"],
    ["IMLI CHOWK DT", 22.78588, 86.15996, "transformer"],
    ["IMPERIAL AUTO DT", 22.7906, 86.14311, "transformer"],
    ["J.P. NAGAR DT", 22.79174, 86.16931, "transformer"],
    ["J.P.UDYAAN DT", 22.78708, 86.17239, "transformer"],
    ["JAI MATA DI DT", 22.77732, 86.13105, "transformer"],
    ["JALARAM FORGING DT", 22.79476, 86.13139, "transformer"],
    ["JAMSHEDPUR AUTO", 22.80331, 86.10616, "transformer"],
    ["JAMUNA SARASWATI DT", 22.78755, 86.152, "transformer"],
    ["Jayshree Ford DT", 22.79181, 86.14311, "transformer"],
    ["JIADA CPSS-1", 22.7854, 86.16393, "transformer"],
    ["JIADA CPSS-2", 22.78546, 86.16393, "transformer"],
    ["JIADA DT", 22.78536, 86.16391, "transformer"],
    ["JIVANPUR DT", 22.7807, 86.02356, "transformer"],
    ["JJCO DT", 22.78777, 86.14927, "transformer"],
    ["JJCO PRESS METAL DT", 22.78795, 86.14885, "transformer"],
    ["JSR CHEMICAL & MINERALS DT", 22.80135, 86.11506, "transformer"],
    ["K.K STEEL DT", 22.79443, 86.12604, "transformer"],
    ["KALPANAPURI CPSS", 22.78758, 86.15273, "transformer"],
    ["KALPANAPURI DT", 22.78572, 86.15235, "transformer"],
    ["KANCHAN ENGG. DT", 22.78958, 86.14239, "transformer"],
    ["Kerala Public School DT", 22.82094, 86.09408, "transformer"],
    ["KHEMKHA DT", 22.79806, 86.11808, "transformer"],
    ["KOLABIRA DT", 22.79063, 86.02699, "transformer"],
    ["K-PURI DT 1", 22.78581, 86.15238, "transformer"],
    ["KRD DT", 22.79549, 86.13206, "transformer"],
    ["KRISHNA NAGAR DT", 22.78238, 86.12447, "transformer"],
    ["KUNJ VIHAR DT", 22.79696, 86.14215, "transformer"],
    ["LAKSMI MEDHA DT", 22.78627, 86.15462, "transformer"],
    ["LAL BUILDING DT", 22.81466, 86.10262, "transformer"],
    ["Lal Building DT 500kVA", 22.81487, 86.10257, "transformer"],
    ["LAL CHAND & SONS DT", 22.7863, 86.13321, "transformer"],
    ["LIC COLONY DT", 22.7973, 86.15609, "transformer"],
    ["LIC DT-1", 22.78535, 86.16903, "transformer"],
    ["LIC DT-2", 22.78535, 86.16902, "transformer"],
    ["LOKNATH COMPLEX DT", 22.78683, 86.16483, "transformer"],
    ["Lovely Engg DT/PH5", 22.82294, 86.08916, "transformer"],
    ["LUPUNGDIH DT", 22.76878, 86.10261, "transformer"],
    ["M 5 DT", 22.78642, 86.16995, "transformer"],
    ["M.P COMPLEX DT", 22.78676, 86.16365, "transformer"],
    ["M.P MOTI DT", 22.784, 86.17144, "transformer"],
    ["M.P.NAGINA DT", 22.78692, 86.17042, "transformer"],
    ["M.V. ENGG. DT", 22.79907, 86.12171, "transformer"],
    ["M/S NATIONAL DT", 22.78603, 86.13835, "transformer"],
    ["MA TYPE", 22.78879, 86.15468, "transformer"],
    ["MAA BHAWANI DT", 22.79534, 86.12858, "transformer"],
    ["MAA GAYATRI DT", 22.82921, 86.06858, "transformer"],
    ["MAA KALI DT", 22.78889, 86.16883, "transformer"],
    ["MAA SANTOSHI DT", 22.78842, 86.14225, "transformer"],
    ["MAA SHAKTI DT", 22.79838, 86.12076, "transformer"],
    ["MADHU ENCLAVE DT", 22.80534, 86.12451, "transformer"],
    ["MAHABIR NAGAR DT", 22.77659, 86.16489, "transformer"],
    ["MAHAMAYA DT", 22.78802, 86.16229, "transformer"],
    ["MAKERS INDUSTRIES DT", 22.77883, 86.13788, "transformer"],
    ["MAMAJEE COMPLEX DT", 22.81422, 86.10427, "transformer"],
    ["MEDIA MAGIX DT", 22.80323, 86.14028, "transformer"],
    ["MERUDIH DT", 22.78682, 86.11591, "transformer"],
    ["METRO INDUSTRIES DT", 22.79109, 86.14597, "transformer"],
    ["MIG DT-1", 22.77669, 86.15858, "transformer"],
    ["MIG DT-2", 22.77673, 86.15858, "transformer"],
    ["MIRAJ AUTO DT", 22.79408, 86.133, "transformer"],
    ["MITHILA MOTORS DT U-1", 22.79121, 86.145, "transformer"],
    ["MITHILA MOTORS U-3 DT", 22.7907, 86.14979, "transformer"],
    ["MITHILA MOTORS WORKS DT", 22.79629, 86.12293, "transformer"],
    ["MODERN CORPORATION DT", 22.78662, 86.14601, "transformer"],
    ["MOHANPUR DT", 22.84551, 86.10431, "transformer"],
    ["MOHOLDIH DT", 22.77065, 86.09886, "transformer"],
    ["MS MALL DT", 22.78761, 86.15916, "transformer"],
    ["MTC DT", 22.81013, 86.11262, "transformer"],
    ["Multi-Tech DT Ph#1", 22.78647, 86.13686, "transformer"],
    ["MUSRIKUDAR DT", 22.83999, 86.10411, "transformer"],
    ["NALIN RUBBER DT", 22.80383, 86.11806, "transformer"],
    ["NALIN RUBBER UNIT-3 DT", 22.80459, 86.11597, "transformer"],
    ["NARBHERAM HERO DT", 22.7996, 86.12988, "transformer"],
    ["NARBHERAM MOTORS TVS", 22.8035, 86.12088, "transformer"],
    ["NEW TOWN COMMERCIAL DT", 22.8271, 86.06432, "transformer"],
    ["NEXA DT", 22.79237, 86.14176, "transformer"],
    ["NU- CARBONICS DT", 22.80133, 86.10674, "transformer"],
    ["NUTANDIH DT", 22.77278, 86.08616, "transformer"],
    ["ORBIT DT-1", 22.79087, 86.16546, "transformer"],
    ["ORBIT DT-2", 22.7907, 86.16579, "transformer"],
    ["PANCSHEEL ENCLAVE DT", 22.79541, 86.14007, "transformer"],
    ["PANCSHEEL TOWER DT", 22.80424, 86.12254, "transformer"],
    ["PARAMOUNT DT", 22.78713, 86.13339, "transformer"],
    ["PARINA METAL DT", 22.78617, 86.1493, "transformer"],
    ["PARSURAM DT", 22.80341, 86.11695, "transformer"],
    ["PASA SALES DT", 22.80708, 86.1158, "transformer"],
    ["PENDRABEDA DT", 22.85391, 86.07124, "transformer"],
    ["PENWELL PLASTIC", 22.78103, 86.13613, "transformer"],
    ["PH# 4 DT", 22.80342, 86.10625, "transformer"],
    ["PH#1 DT", 22.78539, 86.13739, "transformer"],
    ["PH#2", 22.78942, 86.1501, "transformer"],
    ["PIONEER BUILDER DT", 22.78672, 86.16468, "transformer"],
    ["POWER DRIVE DT", 22.7905, 86.13705, "transformer"],
    ["PRABHAT PARK DT", 22.78823, 86.16932, "transformer"],
    ["PRAMANIK ABHIYANTRAN DT", 22.78687, 86.15111, "transformer"],
    ["PRASIDH SINGH DT-1", 22.78383, 86.16887, "transformer"],
    ["PRASIDH SINGH DT2", 22.78408, 86.16889, "transformer"],
    ["PRECISION AUTO DT", 22.79087, 86.13722, "transformer"],
    ["PRECISION TOOLS DT", 22.79026, 86.13824, "transformer"],
    ["PRINCE METAL DT", 22.78208, 86.14433, "transformer"],
    ["PROMISE DT", 22.77693, 86.139, "transformer"],
    ["QUALITY STEEL DT", 22.7893, 86.14969, "transformer"],
    ["R P SINHA ANUPAM BIHAR DT", 22.80261, 86.1261, "transformer"],
    ["R.K.M.N DT", 22.7834, 86.1412, "transformer"],
    ["R.P ENTERPRISE DT", 22.78397, 86.13648, "transformer"],
    ["R20 DT", 22.78888, 86.17028, "transformer"],
    ["RAIMARA DT", 22.86844, 86.08319, "transformer"],
    ["RAIN BASERA DT", 22.79401, 86.15889, "transformer"],
    ["RAJ MACHINING DT", 22.79429, 86.12872, "transformer"],
    ["RAJESH SINGH DT", 22.79567, 86.13684, "transformer"],
    ["RAJGAON DT", 22.77622, 86.08314, "transformer"],
    ["RAJIV ASSOCIATE DT", 22.78745, 86.14623, "transformer"],
    ["Rajmahal SK DT", 22.6971, 85.93211, "transformer"],
    ["RAMCHANDERPUR DT", 22.82871, 86.08018, "transformer"],
    ["RAMESHWARAM DT-1", 22.80364, 86.12451, "transformer"],
    ["RANI SATI PIPE DT", 22.78252, 86.12487, "transformer"],
    ["RANI SATI PLASTIC DT", 22.80733, 86.11097, "transformer"],
    ["RANTECH DT", 22.78834, 86.14507, "transformer"],
    ["RAPCHA DT", 22.84587, 86.08078, "transformer"],
    ["RAX HYDRALLICS DT", 22.82515, 86.07368, "transformer"],
    ["RAX HYDRULIC DT /LS", 22.77497, 86.13788, "transformer"],
    ["RD 5&6 DT 2", 22.7785, 86.16134, "transformer"],
    ["RD 5&6 DT1", 22.77865, 86.16155, "transformer"],
    ["Reliable Bricks DT/PH5", 22.82223, 86.08867, "transformer"],
    ["RELIANCE JIO/VIDHUT DT", 22.78906, 86.14345, "transformer"],
    ["RENAULT DT", 22.80288, 86.12536, "transformer"],
    ["RISHI APARTMENT DT", 22.79531, 86.14196, "transformer"],
    ["ROAD NO. 32 DT", 22.7802, 86.16627, "transformer"],
    ["ROAD NO.14 DT", 22.77418, 86.1634, "transformer"],
    ["ROHAN ENT. DT", 22.78543, 86.13572, "transformer"],
    ["ROY BROTHERS DT", 22.79064, 86.1394, "transformer"],
    ["S -TYPE DT2", 22.78845, 86.1568, "transformer"],
    ["S&S IND. DT /PH#5", 22.82031, 86.08826, "transformer"],
    ["S.S WIRE DT", 22.78573, 86.14081, "transformer"],
    ["SACHDEVA ENGG. DT", 22.79049, 86.14019, "transformer"],
    ["SAHARA GARDEN 250 KVA DT-1", 22.78202, 86.15653, "transformer"],
    ["SAHARA 500 KVA DT", 22.78149, 86.15423, "transformer"],
    ["SAHARA GARDEN 315 KVA DT-2", 22.782, 86.15653, "transformer"],
    ["SAI AANCHAL DT", 22.80427, 86.12272, "transformer"],
    ["SAI KALPANA DT", 22.80934, 86.12726, "transformer"],
    ["SAI KRIPA DT", 22.78336, 86.12393, "transformer"],
    ["SAI PATH DT-1", 22.7776, 86.1567, "transformer"],
    ["SAI PATH DT2", 22.77739, 86.15615, "transformer"],
    ["SALAMPATHAR DT", 22.86369, 86.09347, "transformer"],
    ["SALDIH DT", 22.78118, 86.01737, "transformer"],
    ["Saldih DT Ph#5", 22.82089, 86.09417, "transformer"],
    ["SAMBHAV COMPLEX DT", 22.79192, 86.16632, "transformer"],
    ["SAMRIDHI APPARTMRENT DT", 22.79424, 86.16227, "transformer"],
    ["Samudayik Bhawan SK DT", 22.70089, 85.93512, "transformer"],
    ["SANJEEVANI DT", 22.79021, 86.16702, "transformer"],
    ["Sanmati Industries DT,PH5", 22.81785, 86.08899, "transformer"],
    ["Sarita Complex", 22.78685, 86.1691, "transformer"],
    ["SARKAR ENTPRISES DT", 22.78353, 86.1349, "transformer"],
    ["SDS POLYTUBE DT", 22.7878, 86.13284, "transformer"],
    ["SHALDIH BASTI DT 100kVA", 22.79412, 86.15489, "transformer"],
    ["SHALDIH BASTI DT 250kVA", 22.79409, 86.15489, "transformer"],
    ["SHIB AUTO DT", 22.78427, 86.14079, "transformer"],
    ["SHIV SHAKTI DT", 22.77702, 86.13284, "transformer"],
    ["SHIVA NURSING HOME DT", 22.78529, 86.17146, "transformer"],
    ["SHIVALIK APARTMENT DT (RJ CONS.)", 22.77874, 86.1555, "transformer"],
    ["SHIVALIK INDUSTRIES DT", 22.79039, 86.13679, "transformer"],
    ["SHIVDHAM DT", 22.78, 86.15406, "transformer"],
    ["SHIVRANJANI DT", 22.79032, 86.15612, "transformer"],
    ["Shreja DT", 22.82833, 86.06986, "transformer"],
    ["SHREYA APARTMENT DT", 22.80522, 86.12376, "transformer"],
    ["SHRI VINAYAK ENT. DT", 22.78208, 86.14311, "transformer"],
    ["Sichaivibhag SK DT", 22.69863, 85.93065, "transformer"],
    ["SIGMA VIDHUT DT", 22.7873, 86.1497, "transformer"],
    ["SINGHBHOOM MACHINO DT", 22.78491, 86.13779, "transformer"],
    ["SITARAMPUR DT", 22.77987, 86.11297, "transformer"],
    ["SOM. ENGG. DT", 22.79914, 86.12128, "transformer"],
    ["SOSOGODA DT", 22.87904, 86.08693, "transformer"],
    ["SOUTH BIHAR PLASTIC DT", 22.79006, 86.14408, "transformer"],
    ["SPACEAGE DT", 22.78134, 86.1457, "transformer"],
    ["SRINATH COLLEGE DT", 22.78927, 86.16076, "transformer"],
    ["SRINATH HOMES DT-1", 22.78412, 86.15486, "transformer"],
    ["SRINATH HOMES DT-2", 22.78415, 86.15495, "transformer"],
    ["SRIRAM & SOURYA DT", 22.78284, 86.14303, "transformer"],
    ["STAR AUTO DT", 22.7917, 86.13673, "transformer"],
    ["S-TYPE DT-1", 22.78831, 86.15685, "transformer"],
    ["SUB URBAN DT", 22.80755, 86.10947, "transformer"],
    ["SUBASH PARK DT", 22.7852, 86.17039, "transformer"],
    ["SUDHAPUR DT", 22.87855, 86.09437, "transformer"],
    ["SUMITRA ENTERPRISE DT", 22.78882, 86.149, "transformer"],
    ["SUN RESIDENCY", 22.81769, 86.10395, "transformer"],
    ["SUNDRAM DT", 22.7779, 86.13587, "transformer"],
    ["Sunfab DT Ph#4", 22.81003, 86.10728, "transformer"],
    ["SUNTECH INDUSTRIES DT L/S", 22.82642, 86.07686, "transformer"],
    ["SURAJ HOSPITALITY DT", 22.78962, 86.15177, "transformer"],
    ["SWASTIK DT", 22.78994, 86.14584, "transformer"],
    ["SWIFT STRIPS DT", 22.78352, 86.12961, "transformer"],
    ["TARA APARTMENT DT", 22.79613, 86.14208, "transformer"],
    ["TARUN TOOLS DT", 22.78932, 86.15864, "transformer"],
    ["TECHMACHINO DT", 22.77672, 86.13399, "transformer"],
    ["TECHMECHO DT", 22.78885, 86.14182, "transformer"],
    ["TIRUPATI DT", 22.78641, 86.14635, "transformer"],
    ["TISCO SOCIETY DT-1", 22.80278, 86.12764, "transformer"],
    ["TISCO SOCIETY DT-2", 22.80416, 86.12465, "transformer"],
    ["TRINETRAM DT", 22.79129, 86.15991, "transformer"],
    ["TRIPURARI COLONY DT", 22.79414, 86.15719, "transformer"],
    ["UDAYPUR DT", 22.77145, 86.09419, "transformer"],
    ["UNIVERSAL PAINT DT", 22.80702, 86.10765, "transformer"],
    ["UPPERBEDA DT", 22.82759, 86.08063, "transformer"],
    ["UTKAL (ALFA) AUTO COACH DT", 22.80087, 86.12872, "transformer"],
    ["VARUN ENT. DT", 22.78351, 86.14404, "transformer"],
    ["VIBHA HOMES DT", 22.77929, 86.15447, "transformer"],
    ["VINAYAK GARDEN DT", 22.80725, 86.11996, "transformer"],
    ["VISHWAKARMA DT", 22.78894, 86.14532, "transformer"],
    ["VIVEK VIHAR DT", 22.80489, 86.12882, "transformer"],
    ["XITE", 22.83429, 86.08965, "transformer"],
    ["RAMESHWARAM DT-2", 22.80364, 86.12451, "transformer"],
    ["11 KV CPSS AIADA", 22.7854, 86.1638, "transformer"],
    ["6.6 KV CPSS AIADA", 22.78547, 86.16393, "transformer"],
    ["6.6KV RMU JAI PRAKASH UDYAN/S-11 SOURCE", 22.78698, 86.17233, "rmu"],
    ["630 KVA DT RMU ,CPSS#3 Kalpnapuri,Ph#2 DOMESTIC RING", 22.78756, 86.15272, "rmu"],
    ["A S N Developer RMU PH1-2/DM", 22.78494, 86.17243, "rmu"],
    ["ADARSH NAGAR RMU GAMHARIA", 22.81663, 86.10371, "rmu"],
    ["ADHUNIK CONST. RMU PH#2 DM", 22.78855, 86.16322, "rmu"],
    ["Aditya Enclave RMU PH!/Dom", 22.77902, 86.15521, "rmu"],
    ["Aditya Garden RMU", 22.79745, 86.14414, "rmu"],
    ["Aditya Garden RMU PH#2/R-1", 22.79246, 86.14224, "rmu"],
    ["AIADA RMU PH1-2/DM", 22.78562, 86.16409, "rmu"],
    ["AK ASSOCIATE RMU", 22.78875, 86.16893, "rmu"],
    ["ALmament Reagent RMU", 22.77741, 86.13508, "rmu"],
    ["AMVI POLYTEC RMU", 22.78153, 86.13932, "rmu"],
    ["ANAC RMU PH#2 /DOM", 22.78732, 86.15331, "rmu"],
    ["ANIL SYSTEM RMU PH#2/R-3", 22.78983, 86.1469, "rmu"],
    ["Anjaya Ispat Unit-1 RMU", 22.81408, 86.08562, "rmu"],
    ["Anjaya Ispat Unit-2 RMU", 22.81693, 86.08837, "rmu"],
    ["ANUPAM BIHAR/ R.P SINHA RMU", 22.80237, 86.12659, "rmu"],
    ["ANVIL CABLE RMU LS", 22.8296, 86.06824, "rmu"],
    ["Apex Auto RMU PH 7/R-2", 22.79789, 86.13004, "rmu"],
    ["Aruneshwar RMU LS", 22.82677, 86.07372, "rmu"],
    ["Ashirwad Steel RMU PH5/R-1/20", 22.81783, 86.08635, "rmu"],
    ["Ashiyana trade centre RMU PH1-2/DM", 22.79053, 86.1542, "rmu"]

        ];
        // Create a marker cluster group
        var markers = L.markerClusterGroup();
        var markerList = [];
        // Add all markers to the cluster group
        equipment.forEach(function (loc) {
            var marker = L.marker([loc[1], loc[2]], { icon: icons[loc[3]] });
            markerList.push({ marker: marker, lat: loc[1], lon: loc[2], name: loc[0], type: loc[3] });
            markers.addLayer(marker);
        });
        map.addLayer(markers);
        // Function to calculate distance using Haversine formula
        function calculateDistance(lat1, lon1, lat2, lon2) {
            function toRad(value) { return value * Math.PI / 180; }
            var R = 6371; // Earth's radius in km
            var dLat = toRad(lat2 - lat1);
            var dLon = toRad(lon2 - lon1);
            var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                    Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *
                    Math.sin(dLon / 2) * Math.sin(dLon / 2);
            var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
            return (R * c).toFixed(2);
        }
        // Update popup content with distance from user location
        function updateDistances(userLat, userLon) {
            markerList.forEach(function (item) {
                var distance = calculateDistance(userLat, userLon, item.lat, item.lon);
                var googleMapsLink = `https://www.google.com/maps?q=${item.lat},${item.lon}`;
                var popupContent = `
                    <div class="popup-content">
                        <b>${item.name}</b><br>
                        Type: ${item.type.charAt(0).toUpperCase() + item.type.slice(1)}<br>
                        üìè ${distance} km away<br>
                        üó∫Ô∏è <a href="${googleMapsLink}" target="_blank">View on Map</a>
                    </div>`;
                item.marker.bindPopup(popupContent);
            });
        }
        // Handle user location
        function onLocationFound(e) {
            var radius = e.accuracy / 2;
            if (window.userMarker) {
                map.removeLayer(window.userMarker);
                map.removeLayer(window.accuracyCircle);
            }
            window.userMarker = L.marker(e.latlng, { icon: icons.user }).addTo(map)
                .bindPopup("<b>You are here</b>").openPopup();
            window.accuracyCircle = L.circle(e.latlng, { radius: radius, color: 'blue', fillOpacity: 0.2 }).addTo(map);
            updateDistances(e.latlng.lat, e.latlng.lng);
        }
        function onLocationError(e) {
            alert("Location access denied or unavailable.");
        }
        map.locate({ setView: true, maxZoom: 16, watch: true, enableHighAccuracy: true });
        map.on('locationfound', onLocationFound);
        map.on('locationerror', onLocationError);
        // Search and filter functionality with dropdown
        var searchInput = document.getElementById('search');
        var filterSelect = document.getElementById('filter');
        var dropdown = document.getElementById('search-dropdown');
        function updateMarkersAndDropdown() {
            var searchText = searchInput.value.toLowerCase();
            var filterType = filterSelect.value;
            // Filter equipment for dropdown suggestions
            var suggestions = markerList.filter(function (item) {
                var matchesSearch = item.name.toLowerCase().includes(searchText);
                var matchesFilter = filterType === 'all' || item.type === filterType;
                return matchesSearch && matchesFilter;
            });
            // Update dropdown
            dropdown.innerHTML = '';
            if (searchText && suggestions.length > 0) {
                suggestions.slice(0, 10).forEach(function (item) { // Limit to 10 suggestions
                    var div = document.createElement('div');
                    div.className = 'dropdown-item';
                    div.textContent = item.name;
                    div.onclick = function () {
                        searchInput.value = item.name;
                        dropdown.style.display = 'none';
                        updateMarkers(item.name.toLowerCase(), filterType);
                        map.setView([item.lat, item.lon], 15); // Zoom to selected marker
                    };
                    dropdown.appendChild(div);
                });
                dropdown.style.display = 'block';
            } else {
                dropdown.style.display = 'none';
            }
            // Update map markers
            updateMarkers(searchText, filterType);
        }
        function updateMarkers(searchText, filterType) {
            markers.clearLayers();
            markerList.forEach(function (item) {
                var matchesSearch = item.name.toLowerCase().includes(searchText);
                var matchesFilter = filterType === 'all' || item.type === filterType;
                if (matchesSearch && matchesFilter) {
                    markers.addLayer(item.marker);
                }
            });
        }
        searchInput.addEventListener('input', updateMarkersAndDropdown);
        filterSelect.addEventListener('change', updateMarkersAndDropdown);
        // Hide dropdown when clicking outside
        document.addEventListener('click', function (e) {
            if (!searchInput.contains(e.target) && !dropdown.contains(e.target)) {
                dropdown.style.display = 'none';
            }
        });
        // Show dropdown on focus
        searchInput.addEventListener('focus', updateMarkersAndDropdown);
    </script>
</body>
</html>
